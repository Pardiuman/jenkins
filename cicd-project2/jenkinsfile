pipeline{
    agent none
    stages{
        stage('quality gates check'){
            agent{
                docker {
                    image 'maven'
                    // args '-user root'

                }
            }
            steps{
                script{
                    withSonarQubeEnv(credentialsId: 'sonar-secret') {
                        sh 'mvn clean package sonar:sonar'
                    }
                
                
                    sh 'cd cicd-project2 && mvn clean install'
                }
            }

        }   
        
    }
    
}


//     withSonarQubeEnv('sonarqube'){
                //     sh 'mvn sonar:sonar'
                // }