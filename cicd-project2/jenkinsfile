pipeline{
    agent any
    stages{
        stage('quality gates check'){
            agent{
            docker {
                image 'maven:3.9.3-eclipse-temurin-17'
                args '--user root -v /var/run/docker.sock:/var/run/docker.sock'
                
            }
        }
            steps{
                script{
                    withSonarQubeEnv(credentialsId: 'sonarqube-secret') {
                        sh 'mvn sonar:sonar'
                    }
                
                }
                
            }

        }
        
    }
    
}


//     withSonarQubeEnv('sonarqube'){
                //     sh 'mvn sonar:sonar'
                // }